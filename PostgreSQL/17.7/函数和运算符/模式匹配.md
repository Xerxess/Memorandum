<!-- @import "[TOC]" {cmd="toc" depthFrom=1 depthTo=6 orderedList=false} -->

<!-- code_chunk_output -->

- [PostgreSQL æ¨¡å¼åŒ¹é…](#postgresql-æ¨¡å¼åŒ¹é…)
  - [ğŸ”¥ çƒ­é—¨çŸ¥è¯†ç‚¹ï¼ˆå®é™…å¼€å‘ä¸­å¸¸ç”¨ï¼‰](#-çƒ­é—¨çŸ¥è¯†ç‚¹å®é™…å¼€å‘ä¸­å¸¸ç”¨)
    - [1. LIKE æ“ä½œç¬¦ - æœ€åŸºç¡€çš„æ¨¡å¼åŒ¹é…](#1-like-æ“ä½œç¬¦---æœ€åŸºç¡€çš„æ¨¡å¼åŒ¹é…)
    - [2. POSIX æ­£åˆ™è¡¨è¾¾å¼ - æœ€å¼ºå¤§çš„æ¨¡å¼åŒ¹é…](#2-posix-æ­£åˆ™è¡¨è¾¾å¼---æœ€å¼ºå¤§çš„æ¨¡å¼åŒ¹é…)
    - [3. å¸¸ç”¨æ­£åˆ™è¡¨è¾¾å¼å‡½æ•°](#3-å¸¸ç”¨æ­£åˆ™è¡¨è¾¾å¼å‡½æ•°)
      - [regexp_replace() - æ›¿æ¢åŒ¹é…çš„å­ä¸²](#regexp_replace---æ›¿æ¢åŒ¹é…çš„å­ä¸²)
      - [regexp_match() - è¿”å›åŒ¹é…çš„å­ä¸²æ•°ç»„](#regexp_match---è¿”å›åŒ¹é…çš„å­ä¸²æ•°ç»„)
      - [regexp_split_to_array() - ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼åˆ†å‰²å­—ç¬¦ä¸²](#regexp_split_to_array---ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼åˆ†å‰²å­—ç¬¦ä¸²)
      - [regexp_split_to_table() - åˆ†å‰²å­—ç¬¦ä¸²ä¸ºå¤šè¡Œ](#regexp_split_to_table---åˆ†å‰²å­—ç¬¦ä¸²ä¸ºå¤šè¡Œ)
    - [4. æ­£åˆ™è¡¨è¾¾å¼å…ƒå­—ç¬¦](#4-æ­£åˆ™è¡¨è¾¾å¼å…ƒå­—ç¬¦)
    - [5. å­—ç¬¦ç±»ç®€å†™](#5-å­—ç¬¦ç±»ç®€å†™)
  - [âš¡ ä¸­ç­‰çƒ­åº¦çŸ¥è¯†ç‚¹](#-ä¸­ç­‰çƒ­åº¦çŸ¥è¯†ç‚¹)
    - [6. SIMILAR TO æ“ä½œç¬¦ - SQLæ ‡å‡†çš„æ­£åˆ™è¡¨è¾¾å¼](#6-similar-to-æ“ä½œç¬¦---sqlæ ‡å‡†çš„æ­£åˆ™è¡¨è¾¾å¼)
    - [7. é«˜çº§æ­£åˆ™å‡½æ•°](#7-é«˜çº§æ­£åˆ™å‡½æ•°)
      - [regexp_count() - ç»Ÿè®¡åŒ¹é…æ¬¡æ•°](#regexp_count---ç»Ÿè®¡åŒ¹é…æ¬¡æ•°)
      - [regexp_substr() - æå–åŒ¹é…çš„å­ä¸²](#regexp_substr---æå–åŒ¹é…çš„å­ä¸²)
      - [regexp_instr() - è¿”å›åŒ¹é…ä½ç½®](#regexp_instr---è¿”å›åŒ¹é…ä½ç½®)
      - [regexp_like() - å¸ƒå°”å€¼åˆ¤æ–­æ˜¯å¦åŒ¹é…](#regexp_like---å¸ƒå°”å€¼åˆ¤æ–­æ˜¯å¦åŒ¹é…)
    - [8. æ­£åˆ™è¡¨è¾¾å¼æ ‡å¿—](#8-æ­£åˆ™è¡¨è¾¾å¼æ ‡å¿—)
  - [â„ï¸ å†·é—¨çŸ¥è¯†ç‚¹](#ï¸-å†·é—¨çŸ¥è¯†ç‚¹)
    - [9. è½¬ä¹‰å­—ç¬¦å’Œç‰¹æ®Šåºåˆ—](#9-è½¬ä¹‰å­—ç¬¦å’Œç‰¹æ®Šåºåˆ—)
    - [10. é«˜çº§æ­£åˆ™ç‰¹æ€§](#10-é«˜çº§æ­£åˆ™ç‰¹æ€§)
      - [éè´ªå©ªåŒ¹é…](#éè´ªå©ªåŒ¹é…)
      - [å‰ç»çº¦æŸ](#å‰ç»çº¦æŸ)
      - [åé¡¾çº¦æŸ](#åé¡¾çº¦æŸ)
      - [éæ•è·åˆ†ç»„](#éæ•è·åˆ†ç»„)
    - [11. POSIX å­—ç¬¦ç±»](#11-posix-å­—ç¬¦ç±»)
    - [12. æ’åºå…ƒç´ å’Œç­‰ä»·ç±»](#12-æ’åºå…ƒç´ å’Œç­‰ä»·ç±»)
      - [æ’åºå…ƒç´ ](#æ’åºå…ƒç´ )
      - [ç­‰ä»·ç±»](#ç­‰ä»·ç±»)
    - [13. åŸºç¡€æ­£åˆ™è¡¨è¾¾å¼ï¼ˆBREï¼‰ä¸æ‰©å±•æ­£åˆ™è¡¨è¾¾å¼ï¼ˆEREï¼‰](#13-åŸºç¡€æ­£åˆ™è¡¨è¾¾å¼breä¸æ‰©å±•æ­£åˆ™è¡¨è¾¾å¼ere)
    - [14. æ€§èƒ½è€ƒè™‘](#14-æ€§èƒ½è€ƒè™‘)
      - [ç´¢å¼•æ”¯æŒ](#ç´¢å¼•æ”¯æŒ)
      - [ä¼˜åŒ–å»ºè®®](#ä¼˜åŒ–å»ºè®®)
  - [å®é™…åº”ç”¨ç¤ºä¾‹](#å®é™…åº”ç”¨ç¤ºä¾‹)
    - [éªŒè¯å¸¸è§æ•°æ®æ ¼å¼](#éªŒè¯å¸¸è§æ•°æ®æ ¼å¼)
    - [æ•°æ®æ¸…æ´—å’Œæå–](#æ•°æ®æ¸…æ´—å’Œæå–)
  - [æ³¨æ„äº‹é¡¹](#æ³¨æ„äº‹é¡¹)

<!-- /code_chunk_output -->

# PostgreSQL æ¨¡å¼åŒ¹é…

PostgreSQL æä¾›äº†ä¸‰ç§ä¸»è¦çš„æ¨¡å¼åŒ¹é…æ–¹æ³•ï¼Œæ¯ç§éƒ½æœ‰å…¶é€‚ç”¨åœºæ™¯å’Œç‰¹ç‚¹ã€‚

## ğŸ”¥ çƒ­é—¨çŸ¥è¯†ç‚¹ï¼ˆå®é™…å¼€å‘ä¸­å¸¸ç”¨ï¼‰

### 1. LIKE æ“ä½œç¬¦ - æœ€åŸºç¡€çš„æ¨¡å¼åŒ¹é…

**è¯­æ³•ï¼š**

```sql
string LIKE pattern [ESCAPE escape-character]
string NOT LIKE pattern [ESCAPE escape-character]
```

**é€šé…ç¬¦ï¼š**

- `%` - åŒ¹é…ä»»æ„å­—ç¬¦åºåˆ—ï¼ˆåŒ…æ‹¬ç©ºåºåˆ—ï¼‰
- `_` - åŒ¹é…å•ä¸ªå­—ç¬¦

**ESCAPEå­å¥ï¼š**

```sql
'abc' LIKE 'abc'    true
'abc' LIKE 'a%'     true
'abc' LIKE '_b_'    true
'abc' LIKE 'c'      false

-- ä½¿ç”¨åæ–œæ ä½œä¸ºè½¬ä¹‰å­—ç¬¦
'abc' LIKE 'a\\_c' ESCAPE '\\'     -- falseï¼ˆåŒ¹é…å­—é¢ä¸‹åˆ’çº¿ï¼‰
'a_c' LIKE 'a\\_c' ESCAPE '\\'      -- trueï¼ˆåŒ¹é…å­—é¢ä¸‹åˆ’çº¿ï¼‰

-- ä½¿ç”¨å…¶ä»–å­—ç¬¦ä½œä¸ºè½¬ä¹‰å­—ç¬¦
'abc' LIKE 'a$%c' ESCAPE '$'        -- falseï¼ˆåŒ¹é…å­—é¢ç™¾åˆ†å·ï¼‰
'a%c' LIKE 'a$%c' ESCAPE '$'        -- trueï¼ˆåŒ¹é…å­—é¢ç™¾åˆ†å·ï¼‰
```

**ä¸åŒºåˆ†å¤§å°å†™ç‰ˆæœ¬ï¼š**

```sql
string ILIKE pattern [ESCAPE escape-character]
string NOT ILIKE pattern [ESCAPE escape-character]
```

**æ“ä½œç¬¦ç®€å†™ï¼š**

- `~~` - ç­‰åŒäº `LIKE`
- `~~*` - ç­‰åŒäº `ILIKE`
- `!~~` - ç­‰åŒäº `NOT LIKE`
- `!~~*` - ç­‰åŒäº `NOT ILIKE`

**ç¤ºä¾‹ï¼š**

```sql
'abc' LIKE 'a%'        -- true
'abc' LIKE '_b_'       -- true
'abc' LIKE 'a_c'       -- true
'abc' LIKE 'a\\_c'     -- falseï¼ˆè½¬ä¹‰ä¸‹åˆ’çº¿ï¼‰
'abc' ILIKE 'ABC'      -- true
'abc' ~~ 'a%'          -- true
'abc' !~~ 'a%'         -- false
```

### 2. POSIX æ­£åˆ™è¡¨è¾¾å¼ - æœ€å¼ºå¤§çš„æ¨¡å¼åŒ¹é…

**æ“ä½œç¬¦ï¼š**

- `~` - åŒºåˆ†å¤§å°å†™çš„æ­£åˆ™åŒ¹é…
- `~*` - ä¸åŒºåˆ†å¤§å°å†™çš„æ­£åˆ™åŒ¹é…
- `!~` - ä¸åŒ¹é…ï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰
- `!~*` - ä¸åŒ¹é…ï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰

**ç¤ºä¾‹ï¼š**

```sql
'thomas' ~ 't.*ma'             -- true
'thomas' ~* 'T.*ma'            -- true
'thomas' !~ 't.*max' â†’ t       -- true
'thomas' !~* 'T.*ma'           -- false
```

### 3. å¸¸ç”¨æ­£åˆ™è¡¨è¾¾å¼å‡½æ•°

#### regexp_replace() - æ›¿æ¢åŒ¹é…çš„å­ä¸²

**è¯­æ³•ï¼š**

```sql
regexp_replace ( source , pattern , replacement [ , start [ , N ] ][ , flags ])`ã€‚ï¼ˆæ³¨æ„ï¼Œé™¤éæŒ‡å®šäº† ` start å‚æ•°ï¼Œå¦åˆ™ä¸èƒ½æŒ‡å®š N ï¼Œä½† flags å¯ä»¥éšæ—¶æŒ‡å®šã€‚ï¼‰
```

**ç¤ºä¾‹ï¼š**

```sql
regexp_replace('foobarbaz', 'b..', 'X') -- fooXbaz
regexp_replace('foobarbaz', 'b..', 'X', 'g') -- fooXX
regexp_replace('foobarbaz', 'b(..)', 'X\1Y', 'g') -- fooXarYXazY
regexp_replace('A PostgreSQL function', 'a|e|i|o|u', 'X', 1, 0, 'i') -- X PXstgrXSQL fXnctXXn

-- 'A PostgreSQL function': æºå­—ç¬¦ä¸²ã€‚
-- 'a|e|i|o|u': æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼ï¼ŒåŒ¹é…ä»»ä½•å°å†™å…ƒéŸ³å­—æ¯ã€‚
-- 'X': æ›¿æ¢å­—ç¬¦ä¸²ã€‚
-- 1: å¼€å§‹ä½ç½®ã€‚ä»å­—ç¬¦ä¸²çš„ç¬¬ 1 ä¸ªå­—ç¬¦å¼€å§‹æœç´¢ã€‚
-- 3: ç¬¬ N æ¬¡åŒ¹é…ã€‚ä»…æ›¿æ¢åŒ¹é…åˆ°çš„ç¬¬ 3 ä¸ªç¬¦åˆæ¡ä»¶çš„å­—ç¬¦ã€‚
-- 'i': æ ‡å¿—ä½ã€‚æŒ‡å®šè¿›è¡Œä¸åŒºåˆ†å¤§å°å†™çš„åŒ¹é…ï¼ˆCase-insensitiveï¼‰ã€‚
-- æ‰§è¡Œé€»è¾‘
-- ç¬¬ 1 æ¬¡åŒ¹é…ï¼šå­—ç¬¦ 'A'ï¼ˆå›  'i' æ ‡å¿—ä¸åŒºåˆ†å¤§å°å†™ï¼Œé¦–å­—æ¯åŒ¹é…æˆåŠŸï¼‰ã€‚
-- ç¬¬ 2 æ¬¡åŒ¹é…ï¼šå­—ç¬¦ 'o'ï¼ˆåœ¨ "PostgreSQL" ä¸­ï¼‰ã€‚
-- ç¬¬ 3 æ¬¡åŒ¹é…ï¼šå­—ç¬¦ 'e'ï¼ˆåœ¨ "PostgreSQL" ä¸­ï¼‰ã€‚
-- ç”±äºå‚æ•°æŒ‡å®šåªæ›¿æ¢ç¬¬ 3 ä¸ªåŒ¹é…é¡¹ï¼Œå› æ­¤åªæœ‰å­—ç¬¦ 'e' è¢«æ›¿æ¢ä¸º 'X'ã€‚
regexp_replace('A PostgreSQL function', 'a|e|i|o|u', 'X', 1, 3, 'i') -- A PostgrXSQL function
```

#### regexp_match() - è¿”å›åŒ¹é…çš„å­ä¸²æ•°ç»„

**è¯­æ³•ï¼š**

```sql
regexp_match(string, pattern [, flags ])
```

**ç¤ºä¾‹ï¼š**

```sql
-- å®Œæ•´åŒ¹é…
regexp_match('foobarbequebaz', 'bar.*que')        -- {barbeque}

-- æ•è·ç»„
regexp_match('foobarbequebaz', '(bar)(beque)')    -- {bar,beque}

-- ä¸åŒ¹é…è¿”å›NULL
regexp_match('hello', 'world')                   -- NULL
```

#### regexp_split_to_array() - ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼åˆ†å‰²å­—ç¬¦ä¸²

**è¯­æ³•ï¼š**

```sql
regexp_split_to_array(string, pattern [, flags ])
```

**ç¤ºä¾‹ï¼š**

```sql
-- æŒ‰ç©ºæ ¼åˆ†å‰²
regexp_split_to_array('the quick brown fox', '\s+')
-- {the,quick,brown,fox}

-- æŒ‰é€—å·åˆ†å‰²
regexp_split_to_array('a,b,c', ',')              -- {a,b,c}

-- æŒ‰ä»»æ„éå­—æ¯åˆ†å‰²
regexp_split_to_array('Hello123World456', '[^a-zA-Z]+')
-- {Hello,World,""}
```

#### regexp_split_to_table() - åˆ†å‰²å­—ç¬¦ä¸²ä¸ºå¤šè¡Œ

**è¯­æ³•ï¼š**

```sql
regexp_split_to_table(string, pattern [, flags ])
```

**ç¤ºä¾‹ï¼š**

```sql
SELECT foo FROM regexp_split_to_table('a,b,c', ',') AS foo;
-- è¿”å›ä¸‰è¡Œï¼ša, b, c

SELECT regexp_split_to_table('hello world', '\s+');
-- è¿”å›ä¸¤è¡Œï¼šhello, world
```

### 4. æ­£åˆ™è¡¨è¾¾å¼å…ƒå­—ç¬¦

| å…ƒå­—ç¬¦ | è¯´æ˜ | ç¤ºä¾‹ |
|--------|------|------|
| `.` | åŒ¹é…ä»»æ„å•ä¸ªå­—ç¬¦ | `'a.c'` åŒ¹é… 'abc', 'a1c' |
| `*` | 0æ¬¡æˆ–å¤šæ¬¡é‡å¤ | `'ab*c'` åŒ¹é… 'ac', 'abc', 'abbc' |
| `+` | 1æ¬¡æˆ–å¤šæ¬¡é‡å¤ | `'ab+c'` åŒ¹é… 'abc', 'abbc' |
| `?` | 0æ¬¡æˆ–1æ¬¡é‡å¤ | `'ab?c'` åŒ¹é… 'ac', 'abc' |
| `^` | å­—ç¬¦ä¸²å¼€å§‹ | `'^abc'` åŒ¹é… 'abcdef' |
| `$` | å­—ç¬¦ä¸²ç»“æŸ | `'abc$'` åŒ¹é… 'defabc' |
| `[]` | å­—ç¬¦é›† | `'[abc]'` åŒ¹é… a, b, c |
| `[^]` | æ’é™¤å­—ç¬¦é›† | `'[^abc]'` åŒ¹é…é™¤äº†a,b,cçš„å­—ç¬¦ |
| `|` | æˆ–æ“ä½œ | `'a\|b'` åŒ¹é… a æˆ– b |
| `()` | åˆ†ç»„ | `'(ab)+'` åŒ¹é… 'ab', 'abab' |

### 5. å­—ç¬¦ç±»ç®€å†™

| ç®€å†™ | ç­‰ä»·å­—ç¬¦é›† | è¯´æ˜ |
|------|------------|------|
| `\d` | `[0-9]` | æ•°å­— |
| `\D` | `[^0-9]` | éæ•°å­— |
| `\w` | `[a-zA-Z0-9_]` | å•è¯å­—ç¬¦ |
| `\W` | `[^a-zA-Z0-9_]` | éå•è¯å­—ç¬¦ |
| `\s` | `[ \t\r\n\f]` | ç©ºç™½å­—ç¬¦ |
| `\S` | `[^ \t\r\n\f]` | éç©ºç™½å­—ç¬¦ |

## âš¡ ä¸­ç­‰çƒ­åº¦çŸ¥è¯†ç‚¹

### 6. SIMILAR TO æ“ä½œç¬¦ - SQLæ ‡å‡†çš„æ­£åˆ™è¡¨è¾¾å¼

**è¯­æ³•ï¼š**

```sql
string SIMILAR TO pattern [ESCAPE escape-character]
string NOT SIMILAR TO pattern [ESCAPE escape-character]
```

**ç‰¹ç‚¹ï¼š**

- ç»“åˆäº†LIKEå’Œæ­£åˆ™è¡¨è¾¾å¼çš„ç‰¹æ€§
- é»˜è®¤éœ€è¦åŒ¹é…æ•´ä¸ªå­—ç¬¦ä¸²ï¼ˆé™¤éä½¿ç”¨é€šé…ç¬¦ï¼‰
- æ”¯æŒçš„æ¨¡å¼å…ƒå­—ç¬¦ï¼š`*`, `+`, `?`, `{m}`, `{m,}`, `{m,n}`, `|`, `()`, `[]`
- é€šé…ç¬¦ `%` å’Œ `_` ä»ç„¶å¯ç”¨
- ç‚¹å· . ä¸æ˜¯å…ƒå­—ç¬¦ï¼šåœ¨ SIMILAR TO ä¸­ï¼Œç‚¹å· . åªæ˜¯ä¸€ä¸ªæ™®é€šçš„å­—é¢é‡å­—ç¬¦ï¼Œä¸ä»£è¡¨â€œåŒ¹é…ä»»æ„å­—ç¬¦â€ã€‚
- å¯¹åº”çš„é€šé…ç¬¦ï¼šåœ¨ SIMILAR TO ä¸­ï¼Œä»£è¡¨â€œåŒ¹é…ä»»æ„å•ä¸ªå­—ç¬¦â€çš„é€šé…ç¬¦æ˜¯ä¸‹åˆ’çº¿ _ï¼ˆæ²¿è¢­è‡ª LIKEï¼‰ã€‚


**ç¤ºä¾‹ï¼š**

```sql
'abc' SIMILAR TO '%(b|d)%'              -- true
'abc' SIMILAR TO '(b|c)%'               -- falseï¼ˆéœ€è¦å®Œæ•´åŒ¹é…ï¼‰
'abc' SIMILAR TO '(b|c)*'               -- trueï¼ˆå®Œæ•´åŒ¹é…ï¼‰
'12345' SIMILAR TO '[0-9]{5}'           -- true
'abc' SIMILAR TO 'a.*c'                 -- falseï¼ˆç‚¹å· . ä¸æ˜¯å…ƒå­—ç¬¦ï¼‰
'abc' SIMILAR TO 'a.{1,2}c'             -- false
'abc' SIMILAR TO 'a_*c'                 -- true
SELECT 'abc' SIMILAR TO 'a_{1,2}c'      -- true
```

### 7. é«˜çº§æ­£åˆ™å‡½æ•°

#### regexp_count() - ç»Ÿè®¡åŒ¹é…æ¬¡æ•°

**è¯­æ³•ï¼š**

```sql
regexp_count(string, pattern [, start_position [, flags ]])
```

**ç¤ºä¾‹ï¼š**

```sql
-- ç»Ÿè®¡å¤§å†™å­—æ¯åè·Ÿä»»æ„å­—ç¬¦çš„æ•°é‡
regexp_count('ABCABCAXYaxy', 'A.')          -- 3

-- ä¸åŒºåˆ†å¤§å°å†™ç»Ÿè®¡
regexp_count('ABCABCAXYaxy', 'A.', 1, 'i')  -- 4

-- ä»æŒ‡å®šä½ç½®å¼€å§‹ç»Ÿè®¡
regexp_count('ABCABC', 'AB', 3)             -- 1
```

#### regexp_substr() - æå–åŒ¹é…çš„å­ä¸²

**è¯­æ³•ï¼š**

```sql
regexp_substr(string, pattern [, position [, occurrence [, flags [, subexpression ]]]])
```

**ç¤ºä¾‹ï¼š**

```sql
-- æå–ç¬¬ä¸€ä¸ªåŒ¹é…
regexp_substr('number of your street, town zip, FR', '[^,]+')
-- 'number of your street'

-- æå–ç¬¬äºŒä¸ªåŒ¹é…
regexp_substr('number of your street, town zip, FR', '[^,]+', 1, 2)
-- ' town zip'

-- æ•è·ç»„åŒ¹é…
regexp_substr('ab12cd34ef', '([0-9]+)([a-z]+)', 1, 1, '', 2)
-- 'cd'
```

#### regexp_instr() - è¿”å›åŒ¹é…ä½ç½®

**è¯­æ³•ï¼š**

```sql
regexp_instr(string, pattern [, position [, occurrence [, return_opt [, flags [, subexpression ]]]]])
```

**ç¤ºä¾‹ï¼š**

```sql
-- è¿”å›åŒ¹é…å¼€å§‹ä½ç½®
regexp_instr('ABCDEFGHI', '(C..)(...)', 1, 1)     -- 3

-- è¿”å›åŒ¹é…ç»“æŸä½ç½®
regexp_instr('ABCDEFGHI', '(C..)(...)', 1, 1, 1)  -- 8

-- ä¸åŒºåˆ†å¤§å°å†™
regexp_instr('ABCDEFGHI', '(c..)(...)', 1, 1, 0, 'i')  -- 3
```

#### regexp_like() - å¸ƒå°”å€¼åˆ¤æ–­æ˜¯å¦åŒ¹é…

**è¯­æ³•ï¼š**

```sql
regexp_like(string, pattern [, flags ])
```

**ç¤ºä¾‹ï¼š**

```sql
-- åŸºæœ¬åŒ¹é…
regexp_like('Hello World', 'world')           -- false
regexp_like('Hello World', 'world', 'i')      -- true

-- å¤æ‚æ¨¡å¼
regexp_like('2023-12-25', '^\d{4}-\d{2}-\d{2}$')  -- true
```

### 8. æ­£åˆ™è¡¨è¾¾å¼æ ‡å¿—

| æ ‡å¿— | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| `i` | ä¸åŒºåˆ†å¤§å°å†™ | `'abc' ~ 'ABC'i` |
| `g` | å…¨å±€åŒ¹é…ï¼ˆå‡½æ•°ä¸­ï¼‰ | `regexp_replace('abcabc', 'a', 'x', 'g')` |
| `s` | ç‚¹å·åŒ¹é…æ¢è¡Œç¬¦ | `'a\nc' ~ 'a.c's` |
| `m` | å¤šè¡Œæ¨¡å¼ï¼ˆ^å’Œ$åŒ¹é…è¡Œé¦–è¡Œå°¾ï¼‰ | `'a\nb' ~ '^a'm` |

## â„ï¸ å†·é—¨çŸ¥è¯†ç‚¹

### 9. è½¬ä¹‰å­—ç¬¦å’Œç‰¹æ®Šåºåˆ—

| åºåˆ— | è¯´æ˜ | ASCIIç  |
|------|------|---------|
| `\a` | è­¦å‘Šå­—ç¬¦ï¼ˆBELï¼‰ | 0x07 |
| `\b` | é€€æ ¼å­—ç¬¦ï¼ˆBSï¼‰ | 0x08 |
| `\f` | æ¢é¡µç¬¦ï¼ˆFFï¼‰ | 0x0C |
| `\n` | æ¢è¡Œç¬¦ï¼ˆLFï¼‰ | 0x0A |
| `\r` | å›è½¦ç¬¦ï¼ˆCRï¼‰ | 0x0D |
| `\t` | åˆ¶è¡¨ç¬¦ï¼ˆHTï¼‰ | 0x09 |
| `\v` | å‚ç›´åˆ¶è¡¨ç¬¦ï¼ˆVTï¼‰ | 0x0B |
| `\uXXXX` | Unicodeå­—ç¬¦ï¼ˆ4ä½åå…­è¿›åˆ¶ï¼‰ | Unicode |
| `\xHH` | åå…­è¿›åˆ¶å­—ç¬¦ï¼ˆ2ä½ï¼‰ | ASCII |

### 10. é«˜çº§æ­£åˆ™ç‰¹æ€§

#### éè´ªå©ªåŒ¹é…

```sql
-- è´ªå©ªåŒ¹é…ï¼ˆé»˜è®¤ï¼‰
regexp_replace('<a><b></b></a>', '<.*>', 'X')     -- 'X'

-- éè´ªå©ªåŒ¹é…
regexp_replace('<a><b></b></a>', '<.*?>', 'X')    -- 'X</b></a>'
```

#### å‰ç»çº¦æŸ

- `(?=re)` - æ­£å‘å‰ç»ï¼šåŒ¹é…åé¢æ˜¯reçš„ä½ç½®
- `(?!re)` - è´Ÿå‘å‰ç»ï¼šåŒ¹é…åé¢ä¸æ˜¯reçš„ä½ç½®

#### åé¡¾çº¦æŸ

- `(?<=re)` - æ­£å‘åé¡¾ï¼šåŒ¹é…å‰é¢æ˜¯reçš„ä½ç½®
- `(?<!re)` - è´Ÿå‘åé¡¾ï¼šåŒ¹é…å‰é¢ä¸æ˜¯reçš„ä½ç½®

#### éæ•è·åˆ†ç»„

```sql
-- æ•è·åˆ†ç»„ï¼ˆé»˜è®¤ï¼‰
'(a)(b)' - åˆ›å»ºä¸¤ä¸ªæ•è·ç»„

-- éæ•è·åˆ†ç»„
'(?:a)(b)' - åªåˆ›å»ºä¸€ä¸ªæ•è·ç»„
```

### 11. POSIX å­—ç¬¦ç±»

åœ¨æ­£åˆ™è¡¨è¾¾å¼çš„å­—ç¬¦é›†ä¸­å¯ä»¥ä½¿ç”¨POSIXå­—ç¬¦ç±»ï¼š

```sql
'[[:alnum:]]'   -- å­—æ¯å’Œæ•°å­—
'[[:alpha:]]'   -- å­—æ¯
'[[:digit:]]'   -- æ•°å­—
'[[:lower:]]'   -- å°å†™å­—æ¯
'[[:upper:]]'   -- å¤§å†™å­—æ¯
'[[:space:]]'   -- ç©ºç™½å­—ç¬¦
'[[:punct:]]'   -- æ ‡ç‚¹ç¬¦å·
'[[:blank:]]'   -- ç©ºæ ¼å’Œåˆ¶è¡¨ç¬¦
'[[:cntrl:]]'   -- æ§åˆ¶å­—ç¬¦
'[[:graph:]]'   -- å›¾å½¢å­—ç¬¦ï¼ˆéç©ºæ ¼ã€éæ§åˆ¶å­—ç¬¦ï¼‰
'[[:print:]]'   -- å¯æ‰“å°å­—ç¬¦
'[[:xdigit:]]'  -- åå…­è¿›åˆ¶æ•°å­—
```

### 12. æ’åºå…ƒç´ å’Œç­‰ä»·ç±»

#### æ’åºå…ƒç´ 

```sql
'[.ch.]'  -- åœ¨å­—ç¬¦é›†ä¸­ä½œä¸ºå•ä¸ªå­—ç¬¦å¤„ç†ï¼ˆä¸»è¦ç”¨äºæ’åºè§„åˆ™æ•æ„Ÿçš„ç¯å¢ƒï¼‰
```

#### ç­‰ä»·ç±»

```sql
'[=o=]'   -- åŒ¹é…ä¸'o'ç­‰ä»·çš„å­—ç¬¦ï¼ˆåœ¨æŸäº›è¯­è¨€ç¯å¢ƒä¸­å¯èƒ½åŒ…æ‹¬Ã³ã€Ã²ç­‰ï¼‰
```

### 13. åŸºç¡€æ­£åˆ™è¡¨è¾¾å¼ï¼ˆBREï¼‰ä¸æ‰©å±•æ­£åˆ™è¡¨è¾¾å¼ï¼ˆEREï¼‰

PostgreSQL ä½¿ç”¨æ‰©å±•æ­£åˆ™è¡¨è¾¾å¼ï¼ˆEREï¼‰ï¼Œä½†åœ¨æŸäº›æƒ…å†µä¸‹éœ€è¦äº†è§£ä¸¤è€…çš„åŒºåˆ«ï¼š

**BREéœ€è¦è½¬ä¹‰çš„å…ƒå­—ç¬¦ï¼š**

- `\(`, `\)`, `\{`, `\}`, `\|`

**EREä¸éœ€è¦è½¬ä¹‰çš„å…ƒå­—ç¬¦ï¼š**

- `(`, `)`, `{`, `}`, `|`

### 14. æ€§èƒ½è€ƒè™‘

#### ç´¢å¼•æ”¯æŒ

- `LIKE` åœ¨æŸäº›æƒ…å†µä¸‹å¯ä»¥ä½¿ç”¨B-treeç´¢å¼•ï¼ˆç‰¹åˆ«æ˜¯ `pattern LIKE 'prefix%'`ï¼‰
- æ­£åˆ™è¡¨è¾¾å¼é€šå¸¸æ— æ³•ä½¿ç”¨æ ‡å‡†ç´¢å¼•
- å¯ä»¥åˆ›å»ºä¸“é—¨çš„å‡½æ•°ç´¢å¼•æˆ–ä½¿ç”¨pg_trgmæ‰©å±•

#### ä¼˜åŒ–å»ºè®®

```sql
-- ä½¿ç”¨å‰ç¼€åŒ¹é…åˆ©ç”¨ç´¢å¼•
WHERE column LIKE 'prefix%'

-- é¿å…åœ¨æ¨¡å¼å¼€å¤´ä½¿ç”¨é€šé…ç¬¦
-- ä¸æ¨èï¼šWHERE column LIKE '%middle%'

-- å¯¹äºå¤æ‚çš„æ­£åˆ™åŒ¹é…ï¼Œè€ƒè™‘æ·»åŠ çº¦æŸ
WHERE column ~ '^[0-9]{3}-[0-9]{2}-[0-9]{4}$'
```

## å®é™…åº”ç”¨ç¤ºä¾‹

### éªŒè¯å¸¸è§æ•°æ®æ ¼å¼

```sql
-- é‚®ç®±éªŒè¯
SELECT email FROM users
WHERE email ~ '^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}$';

-- ç”µè¯å·ç éªŒè¯
SELECT phone FROM contacts
WHERE phone ~ '^\+?[0-9]{1,3}[-.\s]?[0-9]{3,4}[-.\s]?[0-9]{3,4}[-.\s]?[0-9]{4}$';

-- IPåœ°å€éªŒè¯
SELECT ip FROM logs
WHERE ip ~ '^((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$';

-- æ—¥æœŸæ ¼å¼éªŒè¯ï¼ˆYYYY-MM-DDï¼‰
SELECT date_str FROM events
WHERE date_str ~ '^\d{4}-\d{2}-\d{2}$';
```

### æ•°æ®æ¸…æ´—å’Œæå–

```sql
-- æå–URLä¸­çš„åŸŸå
SELECT regexp_replace(url, '^https?://([^/]+).*', '\1') AS domain
FROM websites;

SELECT regexp_replace('https://www.baidu.com', '^https?://([^/]+).*', '\1') -- www.baidu.com

-- æ¸…ç†ç”µè¯å·ç æ ¼å¼
SELECT regexp_replace(phone, '[^0-9+]', '', 'g') AS clean_phone
FROM contacts;

SELECT 
    phone AS original,
    regexp_replace(phone, '[^0-9+]', '', 'g') AS cleaned
FROM (VALUES('+86 (010) 1234-5678'),('138-1111-2222'),('Contact: 400.800.1234')
) AS t(phone);

-- åˆ†å‰²å…¨åä¸ºåå’Œå§“
SELECT 
(regexp_split_to_array('å° æ˜', '\s+'))[1] AS first_name,
(regexp_split_to_array('å° æ˜', '\s+'))[array_length(regexp_split_to_array('å° æ˜', '\s+'), 1)]

-- åŒä¸Š ä½¿ç”¨å­å­æŸ¥è¯¢ æ€§èƒ½è¾ƒå¥½
SELECT 
parts[1] AS first_name,
parts[array_upper(parts, 1)] AS last_name
FROM (
SELECT regexp_split_to_array('å° æ˜', '\s+') AS parts
) AS sub;
```

## æ³¨æ„äº‹é¡¹

1. **è½¬ä¹‰å¤„ç†**ï¼šåœ¨æ¨¡å¼ä¸­ä½¿ç”¨åæ–œæ æ—¶éœ€è¦æ³¨æ„åŒè½¬ä¹‰é—®é¢˜
2. **ç¼–ç é—®é¢˜**ï¼šç¡®ä¿æ•°æ®åº“å’Œå®¢æˆ·ç«¯ä½¿ç”¨ç›¸åŒçš„å­—ç¬¦ç¼–ç 
3. **æ€§èƒ½å½±å“**ï¼šå¤æ‚çš„æ­£åˆ™è¡¨è¾¾å¼å¯èƒ½å½±å“æŸ¥è¯¢æ€§èƒ½
4. **ç‰ˆæœ¬å…¼å®¹æ€§**ï¼šä¸åŒPostgreSQLç‰ˆæœ¬çš„æ­£åˆ™åŠŸèƒ½å¯èƒ½æœ‰ç»†å¾®å·®å¼‚
5. **NULLå¤„ç†**ï¼šæ‰€æœ‰åŒ¹é…å‡½æ•°åœ¨é‡åˆ°NULLæ—¶éƒ½è¿”å›NULL
