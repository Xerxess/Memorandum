# 字符串函数和操作符

### 字符串连接操作符
| 函数/操作符 | 描述 | 示例 |
|------------|------|------|
| `text` `\|\|` `text` → `text` | 连接两个字符串。 | `'Post' \|\| 'greSQL'` → `PostgreSQL` |
| `text` `\|\|` `anynonarray` → `text`<br>`anynonarray` `\|\|` `text` → `text` | 将非字符串输入转换为文本，然后连接两个字符串。 | `'Value: ' \|\| 42` → `Value: 42` |
| `btrim` ( `string` `text` [, `characters` `text` ] ) → `text` | 从字符串开头和结尾移除最长的只包含指定字符的字符串。 | `btrim('xyxtrimyyx', 'xyz')` → `trim` |
| `text` `IS` [NOT] [`form`] `NORMALIZED` → `boolean` | 检查字符串是否处于指定的 Unicode 规范化形式。 | `U&'\0061\0308bc' IS NFD NORMALIZED` → `t` |
| `bit_length` ( `text` ) → `integer` | 返回字符串中的位数（8 倍于 `octet_length`）。 | `bit_length('jose')` → `32` |
| `char_length` ( `text` ) → `integer`<br>`character_length` ( `text` ) → `integer` | 返回字符串中的字符数。 | `char_length('josé')` → `4` |
| `lower` ( `text` ) → `text` | 根据数据库区域设置规则将字符串转换为全小写。 | `lower('TOM')` → `tom` |
| `lpad` ( `string` `text`, `length` `integer` [, `fill` `text` ] ) → `text` | 通过在前面添加填充字符来扩展字符串到指定长度。 | `lpad('hi', 5, 'xy')` → `xyxhi` |
| `ltrim` ( `string` `text` [, `characters` `text` ] ) → `text` | 从字符串开头移除最长的只包含指定字符的字符串。 | `ltrim('zzzytest', 'xyz')` → `test` |
| `normalize` ( `text` [, `form` ] ) → `text` | 将字符串转换为指定的 Unicode 规范化形式。 | `normalize(U&'\0061\0308bc', NFC)` → `U&'\00E4bc'` |
| `octet_length` ( `text` ) → `integer` | 返回字符串中的字节数。 | `octet_length('josé')` → `5` |
| `octet_length` ( `character` ) → `integer` | 返回字符串中的字节数。 | `octet_length('abc '::character(4))` → `4` |
| `overlay` ( `string` `text` `PLACING` `newsubstring` `text` `FROM` `start` `integer` [ `FOR` `count` `integer` ] ) → `text` | 替换字符串中从指定位置开始的子字符串。 | `overlay('Txxxxas' placing 'hom' from 2 for 4)` → `Thomas` |
| `position` ( `substring` `text` `IN` `string` `text` ) → `integer` | 返回子字符串在字符串中首次出现的位置。 | `position('om' in 'Thomas')` → `3` |
| `rpad` ( `string` `text`, `length` `integer` [, `fill` `text` ] ) → `text` | 通过在末尾添加填充字符来扩展字符串到指定长度。 | `rpad('hi', 5, 'xy')` → `hixyx` |
| `rtrim` ( `string` `text` [, `characters` `text` ] ) → `text` | 从字符串结尾移除最长的只包含指定字符的字符串。 | `rtrim('testxxzx', 'xyz')` → `test` |
| `substring` ( `string` `text` [ `FROM` `start` `integer` ] [ `FOR` `count` `integer` ] ) → `text` | 提取字符串中的子字符串。 | `substring('Thomas' from 2 for 3)` → `hom` |
| `substring` ( `string` `text` `FROM` `pattern` `text` ) → `text` | 提取匹配 POSIX 正则表达式的第一个子字符串。 | `substring('Thomas' from '...$')` → `mas` |
| `substring` ( `string` `text` `SIMILAR` `pattern` `text` `ESCAPE` `escape` `text` ) → `text` | 提取匹配 SQL 正则表达式的第一个子字符串。 | `substring('Thomas' similar '%#"o_a#"_' escape '#')` → `oma` |
| `trim` ( [ LEADING \| TRAILING \| BOTH ] [ `characters` `text` ] `FROM` `string` `text` ) → `text` | 从字符串的开头、结尾或两端移除最长的指定字符。 | `trim(both 'xyz' from 'yxTomxx')` → `Tom` |
| `unicode_assigned` ( `text` ) → `boolean` | 如果字符串中的所有字符都分配了 Unicode 码点，则返回 `true`。 | |
| `upper` ( `text` ) → `text` | 根据数据库区域设置规则将字符串转换为全大写。 | `upper('tom')` → `TOM` |

## 其他字符串函数和操作符

| 函数/操作符 | 描述 | 示例 |
|------------|------|------|
| `text` `^@` `text` → `boolean` | 如果第一个字符串以第二个字符串开头，则返回 true。 | `'alphabet' ^@ 'alph'` → `t` |
| `ascii` ( `text` ) → `integer` | 返回参数第一个字符的数字代码。 | `ascii('x')` → `120` |
| `chr` ( `integer` ) → `text` | 返回具有给定代码的字符。 | `chr(65)` → `A` |
| `concat` ( `val1` "any" [, `val2` "any" [, ...] ] ) → `text` | 连接所有参数的文本表示。 | `concat('abcde', 2, NULL, 22)` → `abcde222` |
| `concat_ws` ( `sep` `text`, `val1` "any" [, `val2` "any" [, ...] ] ) → `text` | 用分隔符连接除第一个参数外的所有参数。 | `concat_ws(',', 'abcde', 2, NULL, 22)` → `abcde,2,22` |
| `format` ( `formatstr` `text` [, `formatarg` "any" [, ...] ] ) → `text` | 根据格式字符串格式化参数。 | `format('Hello %s, %1$s', 'World')` → `Hello World, World` |
| `initcap` ( `text` ) → `text` | 将每个单词的首字母转换为大写，其余为小写。 | `initcap('hi THOMAS')` → `Hi Thomas` |
| `left` ( `string` `text`, `n` `integer` ) → `text` | 返回字符串中的前 n 个字符。 | `left('abcde', 2)` → `ab` |
| `length` ( `text` ) → `integer` | 返回字符串中的字符数。 | `length('jose')` → `4` |
| `md5` ( `text` ) → `text` | 计算参数的 MD5 哈希值。 | `md5('abc')` → `900150983cd24fb0​d6963f7d28e17f72` |
| `parse_ident` ( `qualified_identifier` `text` [, `strict_mode` `boolean` DEFAULT `true` ] ) → `text[]` | 将限定标识符拆分为标识符数组。 | `parse_ident('"SomeSchema".someTable')` → `{SomeSchema,sometable}` |
| `pg_client_encoding` ( ) → `name` | 返回当前客户端编码名称。 | `pg_client_encoding()` → `UTF8` |
| `quote_ident` ( `text` ) → `text` | 返回适合用作 SQL 语句中标识符的字符串。 | `quote_ident('Foo bar')` → `"Foo bar"` |
| `quote_literal` ( `text` ) → `text` | 返回适合用作 SQL 语句中字符串字面量的字符串。 | `quote_literal(E'O\'Reilly')` → `'O''Reilly'` |
| `quote_literal` ( `anyelement` ) → `text` | 将给定值转换为文本然后引用为字面量。 | `quote_literal(42.5)` → `'42.5'` |
| `quote_nullable` ( `text` ) → `text` | 返回适合用作 SQL 语句中字符串字面量的字符串。 | `quote_nullable(NULL)` → `NULL` |
| `quote_nullable` ( `anyelement` ) → `text` | 将给定值转换为文本然后引用为字面量。 | `quote_nullable(42.5)` → `'42.5'` |

### 正则表达式函数

| 函数 | 描述 | 示例 |
|------|------|------|
| `regexp_count` ( `string` `text`, `pattern` `text` [, `start` `integer` [, `flags` `text` ] ] ) → `integer` | 返回 POSIX 正则表达式在字符串中匹配的次数。 | `regexp_count('123456789012', '\d\d\d', 2)` → `3` |
| `regexp_instr` ( `string` `text`, `pattern` `text` [, `start` `integer` [, `N` `integer` [, `endoption` `integer` [, `flags` `text` [, `subexpr` `integer` ] ] ] ] ] ) → `integer` | 返回第 N 个匹配在字符串中的位置。 | `regexp_instr('ABCDEF', 'c(.)(..)', 1, 1, 0, 'i')` → `3` |
| `regexp_like` ( `string` `text`, `pattern` `text` [, `flags` `text` ] ) → `boolean` | 检查是否存在匹配。 | `regexp_like('Hello World', 'world$', 'i')` → `t` |
| `regexp_match` ( `string` `text`, `pattern` `text` [, `flags` `text` ] ) → `text[]` | 返回第一个匹配中的子字符串。 | `regexp_match('foobarbequebaz', '(bar)(beque)')` → `{bar,beque}` |
| `regexp_matches` ( `string` `text`, `pattern` `text` [, `flags` `text` ] ) → `setof text[]` | 返回匹配中的子字符串。 | `regexp_matches('foobarbequebaz', 'ba.', 'g')` |
| `regexp_replace` ( `string` `text`, `pattern` `text`, `replacement` `text` [, `start` `integer` ] [, `flags` `text` ] ) → `text` | 替换匹配的子字符串。 | `regexp_replace('Thomas', '.[mN]a.', 'M')` → `ThM` |
| `regexp_split_to_array` ( `string` `text`, `pattern` `text` [, `flags` `text` ] ) → `text[]` | 使用正则表达式作为分隔符拆分字符串。 | `regexp_split_to_array('hello world', '\s+')` → `{hello,world}` |
| `regexp_split_to_table` ( `string` `text`, `pattern` `text` [, `flags` `text` ] ) → `setof text` | 使用正则表达式作为分隔符拆分字符串。 | `regexp_split_to_table('hello world', '\s+')` |
| `regexp_substr` ( `string` `text`, `pattern` `text` [, `start` `integer` [, `N` `integer` [, `flags` `text` [, `subexpr` `integer` ] ] ] ] ) → `text` | 返回匹配的子字符串。 | `regexp_substr('ABCDEF', 'c(.)(..)', 1, 1, 'i')` → `CDEF` |

### 其他字符串函数

| 函数 | 描述 | 示例 |
|------|------|------|
| `repeat` ( `string` `text`, `number` `integer` ) → `text` | 重复字符串指定的次数。 | `repeat('Pg', 4)` → `PgPgPgPg` |
| `replace` ( `string` `text`, `from` `text`, `to` `text` ) → `text` | 替换字符串中的所有子字符串。 | `replace('abcdefabcdef', 'cd', 'XX')` → `abXXefabXXef` |
| `reverse` ( `text` ) → `text` | 反转字符串中字符的顺序。 | `reverse('abcde')` → `edcba` |
| `right` ( `string` `text`, `n` `integer` ) → `text` | 返回字符串中的最后 n 个字符。 | `right('abcde', 2)` → `de` |
| `split_part` ( `string` `text`, `delimiter` `text`, `n` `integer` ) → `text` | 在分隔符处拆分字符串并返回第 n 个字段。 | `split_part('abc~@~def~@~ghi', '~@~', 2)` → `def` |
| `starts_with` ( `string` `text`, `prefix` `text` ) → `boolean` | 如果字符串以指定前缀开头，则返回 true。 | `starts_with('alphabet', 'alph')` → `t` |
| `string_to_array` ( `string` `text`, `delimiter` `text` [, `null_string` `text` ] ) → `text[]` | 在分隔符处拆分字符串并形成数组。 | `string_to_array('xx~~yy~~zz', '~~', 'yy')` → `{xx,NULL,zz}` |
| `string_to_table` ( `string` `text`, `delimiter` `text` [, `null_string` `text` ] ) → `setof text` | 在分隔符处拆分字符串并返回行集合。 | `string_to_table('xx~^~yy~^~zz', '~^~', 'yy')` |
| `strpos` ( `string` `text`, `substring` `text` ) → `integer` | 返回子字符串在字符串中的起始位置。 | `strpos('high', 'ig')` → `2` |
| `substr` ( `string` `text`, `start` `integer` [, `count` `integer` ] ) → `text` | 提取字符串中的子字符串。 | `substr('alphabet', 3)` → `phabet` |
| `to_ascii` ( `string` `text` [, `encoding` `name` ] ) → `text` | 将字符串从其他编码转换为 ASCII。 | `to_ascii('Karél')` → `Karel` |
| `to_bin` ( `integer` ) → `text` | 将数字转换为其二进制表示。 | `to_bin(2147483647)` → `1111111111111111111111111111111` |
| `to_hex` ( `integer` ) → `text` | 将数字转换为其十六进制表示。 | `to_hex(2147483647)` → `7fffffff` |
| `to_oct` ( `integer` ) → `text` | 将数字转换为其八进制表示。 | `to_oct(2147483647)` → `17777777777` |
| `translate` ( `string` `text`, `from` `text`, `to` `text` ) → `text` | 替换字符串中匹配的字符。 | `translate('12345', '143', 'ax')` → `a2x5` |
| `unistr` ( `text` ) → `text` | 评估参数中的转义 Unicode 字符。 | `unistr('d\0061t\+000061')` → `data` |